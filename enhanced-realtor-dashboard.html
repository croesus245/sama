<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Realtor Dashboard - MWG Hostels</title>
    <link rel="icon" type="image/png" href="MWG logo@300x.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="theme-system.css">
    <link rel="stylesheet" href="theme-integration.css">
    <link rel="stylesheet" href="universal-bg-system.css">
    <link rel="stylesheet" href="perfect-vibe-theme.css">
    <link rel="stylesheet" href="glass-morphism-global.css">
    <link rel="stylesheet" href="realtor-style.css">
    <link rel="stylesheet" href="advanced-styles.css">
    <style>
        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .dashboard-header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(30, 64, 175, 0.2);
        }
        
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .hostel-management {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .hostel-card {
            display: flex;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            transition: background-color 0.3s ease;
        }
        
        .hostel-card:hover {
            background-color: #f9fafb;
        }
        
        .hostel-image {
            width: 120px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 1.5rem;
        }
        
        .hostel-info {
            flex: 1;
        }
        
        .hostel-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .hostel-details {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }
        
        .availability-toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            margin-left: 1rem;
        }
        
        .availability-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #dc2626;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #16a34a;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .status-available {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .status-unavailable {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .applications-count {
            background: #eff6ff;
            color: #1d4ed8;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            margin-left: 1rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            margin-left: 1rem;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background-color 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .search-filter {
            padding: 1.5rem;
            background: #f8fafc;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .search-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .filter-tabs {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .filter-tab {
            padding: 0.5rem 1rem;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-tab.active {
            background: #1e40af;
            color: white;
            border-color: #1e40af;
        }
        
        .bulk-actions {
            padding: 1rem 1.5rem;
            background: #f3f4f6;
            border-bottom: 1px solid #e5e7eb;
            display: none;
        }
        
        .bulk-actions.show {
            display: block;
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 1rem;
            }
            
            .hostel-card {
                flex-direction: column;
                text-align: center;
            }
            
            .hostel-image {
                margin: 0 0 1rem 0;
            }
            
            .action-buttons {
                margin: 1rem 0 0 0;
            }
        }
    </style>
    <script src="asset-path-fix.js" defer></script>
</head>
<body>
    <!-- Dynamic Background System -->
    <div class="dynamic-background"></div>
    <div class="geometric-overlay"></div>
    <div class="floating-elements">
        <div class="floating-book"></div>
        <div class="floating-graduation"></div>
        <div class="floating-building"></div>
    </div>
    <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>
    
    <div class="dashboard-container">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold mb-2">Enhanced Realtor Dashboard</h1>
                    <p class="opacity-90">Manage your hostel listings and applications efficiently</p>
                </div>
                <div class="text-right">
                    <div class="text-lg font-semibold">Welcome back, <span id="realtorName">Realtor</span>!</div>
                    <div class="text-sm opacity-75" id="currentDate"></div>
                    <button onclick="showProfileModal()" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; color: white; cursor: pointer; font-size: 0.875rem;">
                        <i class="fas fa-user-circle mr-1"></i> Update Profile
                    </button>
                </div>
            </div>
        </div>

        <!-- Dashboard Stats -->
        <div class="dashboard-stats">
            <div class="stat-card">
                <div class="flex items-center">
                    <div class="bg-blue-100 p-3 rounded-full mr-4">
                        <i class="fas fa-home text-blue-600 text-xl"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-gray-800" id="totalHostels">12</div>
                        <div class="text-gray-600">Total Hostels</div>
                    </div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="flex items-center">
                    <div class="bg-green-100 p-3 rounded-full mr-4">
                        <i class="fas fa-check-circle text-green-600 text-xl"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-gray-800" id="availableHostels">8</div>
                        <div class="text-gray-600">Available</div>
                    </div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="flex items-center">
                    <div class="bg-red-100 p-3 rounded-full mr-4">
                        <i class="fas fa-times-circle text-red-600 text-xl"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-gray-800" id="unavailableHostels">4</div>
                        <div class="text-gray-600">Unavailable</div>
                    </div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="flex items-center">
                    <div class="bg-yellow-100 p-3 rounded-full mr-4">
                        <i class="fas fa-file-alt text-yellow-600 text-xl"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-gray-800" id="totalApplications">24</div>
                        <div class="text-gray-600">Applications</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hostel Management -->
        <div class="hostel-management">
            <div class="flex justify-between items-center mb-4">
                <div class="search-filter flex-1 mr-4">
                    <input type="text" id="hostelSearch" class="search-input" placeholder="Search hostels by name, location, or price...">
                    <div class="filter-tabs">
                        <div class="filter-tab active" data-filter="all">All Hostels</div>
                        <div class="filter-tab" data-filter="available">Available</div>
                        <div class="filter-tab" data-filter="unavailable">Unavailable</div>
                        <div class="filter-tab" data-filter="pending">Pending Applications</div>
                    </div>
                </div>
                <button class="btn-primary" onclick="showAddHostelModal()" style="padding: 0.75rem 1.5rem; background: #1e40af; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 0.5rem; white-space: nowrap;">
                    <i class="fas fa-plus"></i> Add New Hostel
                </button>
            </div>
            
            <div class="bulk-actions" id="bulkActions">
                <div class="flex items-center gap-4">
                    <span class="font-semibold">Bulk Actions:</span>
                    <button class="btn-secondary" onclick="bulkSetAvailable()">Set Available</button>
                    <button class="btn-secondary" onclick="bulkSetUnavailable()">Set Unavailable</button>
                    <button class="btn-secondary" onclick="clearBulkSelection()">Clear Selection</button>
                </div>
            </div>
            
            <div id="hostelList">
                <!-- Hostels will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Add Hostel Modal -->
        <div id="addHostelModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto;">
            <div style="background: white; max-width: 600px; margin: 2rem auto; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 700; color: #1e40af;">Add New Hostel</h2>
                    <button onclick="closeAddHostelModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6b7280;">&times;</button>
                </div>
                
                <form id="addHostelForm" onsubmit="return handleAddHostel(event)">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Hostel Name *</label>
                        <input type="text" id="hostelName" required style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Location *</label>
                        <input type="text" id="hostelLocation" required placeholder="e.g., Behind FUTA South Gate" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Price (₦) *</label>
                        <input type="number" id="hostelPrice" required placeholder="45000" min="0" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Image URL</label>
                        <input type="url" id="hostelImage" placeholder="https://example.com/image.jpg" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                        <small style="color: #6b7280; font-size: 0.875rem;">Leave blank for default image</small>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Features (comma-separated)</label>
                        <input type="text" id="hostelFeatures" placeholder="WiFi, Security, Water Supply" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">WhatsApp Number *</label>
                        <input type="tel" id="hostelWhatsApp" required placeholder="2348145653433" pattern="[0-9]{13}" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                        <small style="color: #6b7280; font-size: 0.875rem;">Format: 2348145653433 (country code + number, no spaces)</small>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="hostelAvailable" checked style="width: 1.25rem; height: 1.25rem;">
                            <span style="font-weight: 600; color: #374151;">Available for Booking</span>
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button type="submit" style="flex: 1; padding: 0.75rem; background: #1e40af; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-plus mr-1"></i> Add Hostel
                        </button>
                        <button type="button" onclick="closeAddHostelModal()" style="flex: 1; padding: 0.75rem; background: #e5e7eb; color: #374151; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Edit Hostel Modal -->
        <div id="editHostelModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto;">
            <div style="background: white; max-width: 600px; margin: 2rem auto; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 700; color: #1e40af;">Edit Hostel</h2>
                    <button onclick="closeEditHostelModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6b7280;">&times;</button>
                </div>
                
                <form id="editHostelForm" onsubmit="return handleEditHostel(event)">
                    <input type="hidden" id="editHostelId">
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Hostel Name *</label>
                        <input type="text" id="editHostelName" required style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Location *</label>
                        <input type="text" id="editHostelLocation" required style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Price (₦) *</label>
                        <input type="number" id="editHostelPrice" required min="0" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Image URL</label>
                        <input type="url" id="editHostelImage" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Features (comma-separated)</label>
                        <input type="text" id="editHostelFeatures" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">WhatsApp Number *</label>
                        <input type="tel" id="editHostelWhatsApp" required placeholder="2348145653433" pattern="[0-9]{13}" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                        <small style="color: #6b7280; font-size: 0.875rem;">Format: 2348145653433 (country code + number, no spaces)</small>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="editHostelAvailable" style="width: 1.25rem; height: 1.25rem;">
                            <span style="font-weight: 600; color: #374151;">Available for Booking</span>
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button type="submit" style="flex: 1; padding: 0.75rem; background: #1e40af; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-save mr-1"></i> Save Changes
                        </button>
                        <button type="button" onclick="deleteHostel()" style="padding: 0.75rem 1.5rem; background: #dc2626; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-trash mr-1"></i> Delete
                        </button>
                        <button type="button" onclick="closeEditHostelModal()" style="padding: 0.75rem 1rem; background: #e5e7eb; color: #374151; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Realtor Profile Modal -->
        <div id="profileModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto;">
            <div style="background: white; max-width: 500px; margin: 2rem auto; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 700; color: #1e40af;">
                        <i class="fas fa-user-circle mr-2"></i>Realtor Profile
                    </h2>
                    <button onclick="closeProfileModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6b7280;">&times;</button>
                </div>
                
                <form id="profileForm" onsubmit="return handleProfileUpdate(event)">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Your Name *</label>
                        <input type="text" id="profileName" required placeholder="Your full name" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Default WhatsApp Number *</label>
                        <input type="tel" id="profileWhatsApp" required placeholder="2348145653433" pattern="[0-9]{13}" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1rem;">
                        <small style="color: #6b7280; font-size: 0.875rem;">This will be used as default for new hostels. Format: 2348145653433</small>
                    </div>
                    
                    <div style="background: #eff6ff; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #1e40af;">
                        <p style="font-size: 0.875rem; color: #1e40af; margin: 0;">
                            <i class="fas fa-info-circle mr-1"></i>
                            <strong>How it works:</strong> Students will see a "Contact via WhatsApp" button on your hostel listings. When clicked, it opens WhatsApp with your number pre-filled.
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button type="submit" style="flex: 1; padding: 0.75rem; background: #1e40af; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-save mr-1"></i> Save Profile
                        </button>
                        <button type="button" onclick="closeProfileModal()" style="padding: 0.75rem 1rem; background: #e5e7eb; color: #374151; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="environment-config.js"></script>
    <script src="advanced-features.js"></script>
    <script>
        // Load realtor profile from localStorage
        let realtorProfile = JSON.parse(localStorage.getItem('realtorProfile')) || {
            name: 'Realtor',
            whatsapp: '2348145653433'
        };
        
        // Load hostels from localStorage or use sample data
        let hostels = JSON.parse(localStorage.getItem('realtorHostels')) || [
            {
                id: 1,
                name: "Peace Palace Hostel",
                location: "Behind FUTA South Gate",
                price: 45000,
                image: "https://images.unsplash.com/photo-1555854877-bab0e564b8d5?auto=format&fit=crop&w=400&q=80",
                available: true,
                applications: 5,
                features: ["WiFi", "Security", "Water Supply"],
                whatsapp: "2348145653433"
            },
            {
                id: 2,
                name: "Royal Court Hostel",
                location: "Opposite FUTA Main Gate",
                price: 55000,
                image: "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?auto=format&fit=crop&w=400&q=80",
                available: false,
                applications: 8,
                features: ["24/7 Light", "WiFi", "Security", "Laundry"],
                whatsapp: "2348145653433"
            },
            {
                id: 3,
                name: "Golden Gate Hostel",
                location: "Near FUTA Teaching Hospital",
                price: 40000,
                image: "https://images.unsplash.com/photo-1568605114967-8130f3a36994?auto=format&fit=crop&w=400&q=80",
                available: true,
                applications: 3,
                features: ["WiFi", "Security", "Water Supply", "Parking"],
                whatsapp: "2348145653433"
            },
            {
                id: 4,
                name: "Student Haven",
                location: "FUTA Road",
                price: 38000,
                image: "https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=400&q=80",
                available: true,
                applications: 2,
                features: ["WiFi", "Security"],
                whatsapp: "2348145653433"
            },
            {
                id: 5,
                name: "Elite Residence",
                location: "Behind FUTA North Gate",
                price: 65000,
                image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?auto=format&fit=crop&w=400&q=80",
                available: false,
                applications: 12,
                features: ["24/7 Light", "WiFi", "Security", "Gym", "Swimming Pool"],
                whatsapp: "2348145653433"
            },
            {
                id: 6,
                name: "Comfort Lodge",
                location: "Akure-Owo Road",
                price: 42000,
                image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=400&q=80",
                available: true,
                applications: 4,
                features: ["WiFi", "Security", "Water Supply"],
                whatsapp: "2348145653433"
            }
        ];
        
        // Save hostels to localStorage
        function saveHostels() {
            localStorage.setItem('realtorHostels', JSON.stringify(hostels));
            console.log('✅ Hostels saved to localStorage');
        }
        
        let currentFilter = 'all';
        let selectedHostels = new Set();
        let currentEditingHostelId = null;
        
        // Initialize dashboard
        function initializeDashboard() {
            loadRealtorProfile();
            updateCurrentDate();
            updateStats();
            renderHostels();
            setupEventListeners();
        }
        
        function updateCurrentDate() {
            const now = new Date();
            document.getElementById('currentDate').textContent = Utils.formatDate(now);
        }
        
        function updateStats() {
            const totalHostels = hostels.length;
            const availableHostels = hostels.filter(h => h.available).length;
            const unavailableHostels = totalHostels - availableHostels;
            const totalApplications = hostels.reduce((sum, h) => sum + h.applications, 0);
            
            document.getElementById('totalHostels').textContent = totalHostels;
            document.getElementById('availableHostels').textContent = availableHostels;
            document.getElementById('unavailableHostels').textContent = unavailableHostels;
            document.getElementById('totalApplications').textContent = totalApplications;
        }
        
        function renderHostels(filteredHostels = null) {
            const hostelList = document.getElementById('hostelList');
            const hostelsToRender = filteredHostels || getFilteredHostels();
            
            if (hostelsToRender.length === 0) {
                hostelList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-search text-4xl mb-4"></i>
                        <p>No hostels found matching your criteria</p>
                    </div>
                `;
                return;
            }
            
            hostelList.innerHTML = hostelsToRender.map(hostel => `
                <div class="hostel-card" data-hostel-id="${hostel.id}">
                    <input type="checkbox" class="hostel-checkbox mr-4" 
                           onchange="toggleHostelSelection(${hostel.id})">
                    
                    <img src="${hostel.image}" alt="${hostel.name}" class="hostel-image" loading="lazy">
                    
                    <div class="hostel-info">
                        <div class="hostel-name">${hostel.name}</div>
                        <div class="hostel-details">
                            <i class="fas fa-map-marker-alt mr-1"></i> ${hostel.location}
                        </div>
                        <div class="hostel-details">
                            <i class="fas fa-naira-sign mr-1"></i> ${Utils.formatCurrency(hostel.price)}
                        </div>
                        <div class="hostel-details">
                            <i class="fas fa-star mr-1"></i> ${hostel.features.join(', ')}
                        </div>
                    </div>
                    
                    <div class="flex items-center">
                        <span class="status-badge ${hostel.available ? 'status-available' : 'status-unavailable'}">
                            ${hostel.available ? 'Available' : 'Unavailable'}
                        </span>
                        
                        <label class="availability-toggle">
                            <input type="checkbox" ${hostel.available ? 'checked' : ''} 
                                   onchange="toggleAvailability(${hostel.id}, this.checked)">
                            <span class="slider"></span>
                        </label>
                        
                        <div class="applications-count">
                            ${hostel.applications} Applications
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-secondary" onclick="viewApplications(${hostel.id})">
                                <i class="fas fa-eye mr-1"></i> View
                            </button>
                            <button class="btn-secondary" onclick="editHostel(${hostel.id})">
                                <i class="fas fa-edit mr-1"></i> Edit
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function getFilteredHostels() {
            const searchTerm = document.getElementById('hostelSearch').value.toLowerCase();
            
            let filtered = hostels.filter(hostel => {
                const matchesSearch = hostel.name.toLowerCase().includes(searchTerm) ||
                                    hostel.location.toLowerCase().includes(searchTerm) ||
                                    hostel.price.toString().includes(searchTerm);
                
                switch (currentFilter) {
                    case 'available':
                        return matchesSearch && hostel.available;
                    case 'unavailable':
                        return matchesSearch && !hostel.available;
                    case 'pending':
                        return matchesSearch && hostel.applications > 0;
                    default:
                        return matchesSearch;
                }
            });
            
            return filtered;
        }
        
        function toggleAvailability(hostelId, isAvailable) {
            const hostel = hostels.find(h => h.id === hostelId);
            if (hostel) {
                hostel.available = isAvailable;
                saveHostels(); // Save to localStorage
                updateStats();
                renderHostels();
                
                // Show notification
                const message = `${hostel.name} marked as ${isAvailable ? 'Available' : 'Unavailable'}`;
                notifications.show(message, isAvailable ? 'success' : 'warning');
                
                // Track the action
                Analytics.track('hostel_availability_changed', {
                    hostelId,
                    hostelName: hostel.name,
                    newStatus: isAvailable ? 'available' : 'unavailable'
                });
            }
        }
        
        function toggleHostelSelection(hostelId) {
            if (selectedHostels.has(hostelId)) {
                selectedHostels.delete(hostelId);
            } else {
                selectedHostels.add(hostelId);
            }
            
            const bulkActions = document.getElementById('bulkActions');
            if (selectedHostels.size > 0) {
                bulkActions.classList.add('show');
            } else {
                bulkActions.classList.remove('show');
            }
        }
        
        function bulkSetAvailable() {
            selectedHostels.forEach(hostelId => {
                const hostel = hostels.find(h => h.id === hostelId);
                if (hostel) {
                    hostel.available = true;
                }
            });
            
            saveHostels(); // Save to localStorage
            updateStats();
            renderHostels();
            clearBulkSelection();
            notifications.show(`${selectedHostels.size} hostels marked as available`, 'success');
        }
        
        function bulkSetUnavailable() {
            selectedHostels.forEach(hostelId => {
                const hostel = hostels.find(h => h.id === hostelId);
                if (hostel) {
                    hostel.available = false;
                }
            });
            
            saveHostels(); // Save to localStorage
            updateStats();
            renderHostels();
            clearBulkSelection();
            notifications.show(`${selectedHostels.size} hostels marked as unavailable`, 'warning');
        }
        
        function clearBulkSelection() {
            selectedHostels.clear();
            document.querySelectorAll('.hostel-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });
            document.getElementById('bulkActions').classList.remove('show');
        }
        
        function viewApplications(hostelId) {
            const hostel = hostels.find(h => h.id === hostelId);
            notifications.show(`Viewing ${hostel.applications} applications for ${hostel.name}`, 'info');
            Analytics.track('view_applications', { hostelId, hostelName: hostel.name });
        }
        
        function editHostel(hostelId) {
            const hostel = hostels.find(h => h.id === hostelId);
            if (!hostel) return;
            
            currentEditingHostelId = hostelId;
            
            // Populate the edit form
            document.getElementById('editHostelId').value = hostel.id;
            document.getElementById('editHostelName').value = hostel.name;
            document.getElementById('editHostelLocation').value = hostel.location;
            document.getElementById('editHostelPrice').value = hostel.price;
            document.getElementById('editHostelImage').value = hostel.image;
            document.getElementById('editHostelFeatures').value = hostel.features.join(', ');
            document.getElementById('editHostelWhatsApp').value = hostel.whatsapp || realtorProfile.whatsapp;
            document.getElementById('editHostelAvailable').checked = hostel.available;
            
            // Show the modal
            document.getElementById('editHostelModal').style.display = 'block';
            
            Analytics.track('edit_hostel_opened', { hostelId, hostelName: hostel.name });
        }
        
        // Add Hostel Modal Functions
        function showAddHostelModal() {
            document.getElementById('addHostelModal').style.display = 'block';
            document.getElementById('addHostelForm').reset();
        }
        
        function closeAddHostelModal() {
            document.getElementById('addHostelModal').style.display = 'none';
        }
        
        function handleAddHostel(event) {
            event.preventDefault();
            
            const name = document.getElementById('hostelName').value.trim();
            const location = document.getElementById('hostelLocation').value.trim();
            const price = parseInt(document.getElementById('hostelPrice').value);
            const image = document.getElementById('hostelImage').value.trim() || 
                         'https://images.unsplash.com/photo-1555854877-bab0e564b8d5?auto=format&fit=crop&w=400&q=80';
            const featuresInput = document.getElementById('hostelFeatures').value.trim();
            const features = featuresInput ? featuresInput.split(',').map(f => f.trim()) : ['WiFi', 'Security'];
            const available = document.getElementById('hostelAvailable').checked;
            const whatsapp = document.getElementById('hostelWhatsApp').value.trim() || realtorProfile.whatsapp;
            
            // Generate new ID
            const newId = hostels.length > 0 ? Math.max(...hostels.map(h => h.id)) + 1 : 1;
            
            // Create new hostel object
            const newHostel = {
                id: newId,
                name,
                location,
                price,
                image,
                available,
                applications: 0,
                features,
                whatsapp
            };
            
            // Add to hostels array
            hostels.push(newHostel);
            
            // Save to localStorage
            saveHostels();
            
            // Update UI
            updateStats();
            renderHostels();
            
            // Close modal
            closeAddHostelModal();
            
            // Show success notification
            notifications.show(`✅ ${name} added successfully!`, 'success');
            
            Analytics.track('hostel_added', { hostelId: newId, hostelName: name });
            
            return false;
        }
        
        // Edit Hostel Modal Functions
        function closeEditHostelModal() {
            document.getElementById('editHostelModal').style.display = 'none';
            currentEditingHostelId = null;
        }
        
        function handleEditHostel(event) {
            event.preventDefault();
            
            const hostelId = currentEditingHostelId;
            const hostel = hostels.find(h => h.id === hostelId);
            
            if (!hostel) {
                notifications.show('❌ Hostel not found', 'error');
                return false;
            }
            
            // Update hostel data
            hostel.name = document.getElementById('editHostelName').value.trim();
            hostel.location = document.getElementById('editHostelLocation').value.trim();
            hostel.price = parseInt(document.getElementById('editHostelPrice').value);
            hostel.image = document.getElementById('editHostelImage').value.trim() || hostel.image;
            const featuresInput = document.getElementById('editHostelFeatures').value.trim();
            hostel.features = featuresInput ? featuresInput.split(',').map(f => f.trim()) : hostel.features;
            hostel.whatsapp = document.getElementById('editHostelWhatsApp').value.trim() || realtorProfile.whatsapp;
            hostel.available = document.getElementById('editHostelAvailable').checked;
            
            // Save to localStorage
            saveHostels();
            
            // Update UI
            updateStats();
            renderHostels();
            
            // Close modal
            closeEditHostelModal();
            
            // Show success notification
            notifications.show(`✅ ${hostel.name} updated successfully!`, 'success');
            
            Analytics.track('hostel_updated', { hostelId, hostelName: hostel.name });
            
            return false;
        }
        
        function deleteHostel() {
            const hostelId = currentEditingHostelId;
            const hostel = hostels.find(h => h.id === hostelId);
            
            if (!hostel) {
                notifications.show('❌ Hostel not found', 'error');
                return;
            }
            
            const confirmDelete = confirm(`Are you sure you want to delete "${hostel.name}"? This action cannot be undone.`);
            
            if (confirmDelete) {
                // Remove hostel from array
                hostels = hostels.filter(h => h.id !== hostelId);
                
                // Save to localStorage
                saveHostels();
                
                // Update UI
                updateStats();
                renderHostels();
                
                // Close modal
                closeEditHostelModal();
                
                // Show success notification
                notifications.show(`🗑️ ${hostel.name} deleted successfully`, 'success');
                
                Analytics.track('hostel_deleted', { hostelId, hostelName: hostel.name });
            }
        }
        
        // Close modals when clicking outside
        window.addEventListener('click', function(event) {
            const addModal = document.getElementById('addHostelModal');
            const editModal = document.getElementById('editHostelModal');
            const profileModal = document.getElementById('profileModal');
            
            if (event.target === addModal) {
                closeAddHostelModal();
            }
            if (event.target === editModal) {
                closeEditHostelModal();
            }
            if (event.target === profileModal) {
                closeProfileModal();
            }
        });
        
        // Profile Management Functions
        function showProfileModal() {
            document.getElementById('profileName').value = realtorProfile.name;
            document.getElementById('profileWhatsApp').value = realtorProfile.whatsapp;
            document.getElementById('profileModal').style.display = 'block';
        }
        
        function closeProfileModal() {
            document.getElementById('profileModal').style.display = 'none';
        }
        
        function handleProfileUpdate(event) {
            event.preventDefault();
            
            const newName = document.getElementById('profileName').value.trim();
            const newWhatsApp = document.getElementById('profileWhatsApp').value.trim();
            
            // Validate WhatsApp number format
            if (!/^[0-9]{13}$/.test(newWhatsApp)) {
                notifications.show('❌ WhatsApp number must be 13 digits (e.g., 2348145653433)', 'error');
                return false;
            }
            
            // Update profile
            realtorProfile.name = newName;
            realtorProfile.whatsapp = newWhatsApp;
            
            // Save to localStorage
            localStorage.setItem('realtorProfile', JSON.stringify(realtorProfile));
            
            // Update UI
            document.getElementById('realtorName').textContent = newName;
            
            // Close modal
            closeProfileModal();
            
            // Show success notification
            notifications.show(`✅ Profile updated successfully!`, 'success');
            
            Analytics.track('profile_updated', { name: newName });
            
            return false;
        }
        
        // Load profile name on page load
        function loadRealtorProfile() {
            if (realtorProfile.name) {
                document.getElementById('realtorName').textContent = realtorProfile.name;
            }
        }
        
        function setupEventListeners() {
            // Search functionality
            const searchInput = document.getElementById('hostelSearch');
            searchInput.addEventListener('input', Utils.debounce(() => {
                renderHostels();
            }, 300));
            
            // Filter tabs
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    // Update active tab
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Update filter
                    currentFilter = tab.dataset.filter;
                    renderHostels();
                    
                    Analytics.track('filter_changed', { filter: currentFilter });
                });
            });
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
    
    <!-- Theme System -->
    <script src="theme-toggle.js"></script>

    <script>
        window.addEventListener('error', function(e) {
            if (e.target.tagName === 'IMG') {
                console.warn('Image failed:', e.target.src);
                e.target.src = e.target.src.includes('default') ? '' : 'assets/default-hostel.jpg';
            }
        }, true);
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Promise rejection:', e.reason);
        });
    </script>
    
    <!-- Load Fixed Password System -->
    <script src="realtor-fixed-password-system.js"></script>
    <script>
        // Protect this dashboard - require authentication
        requireRealtorAuth();
        
        // Update UI with realtor name
        updateRealtorDashboardUI();
        
        console.log('✅ Enhanced Realtor Dashboard with Fixed Password System Loaded');
    </script>
</body>
</html>
