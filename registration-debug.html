<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Debug Test</title>
    
    <!-- Load the same CSS files as the main site -->
    <link rel="stylesheet" href="modal-styles.css">
    <link rel="stylesheet" href="glass-morphism-global.css">
    <link rel="stylesheet" href="universal-bg-system.css">
    
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f0f0f0;
            margin: 0;
        }
        .hidden {
            display: none;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007bff;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .debug-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .status-good { color: #28a745; }
        .status-error { color: #dc3545; }
        .status-warning { color: #ffc107; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Registration Modal Debug Test</h1>
        
        <div class="debug-output" id="debugOutput">Starting debug test...\n</div>
        
        <button class="test-button" onclick="testModalOpen()">Test Open Registration Modal</button>
        <button class="test-button" onclick="testModalClose()">Test Close Modal</button>
        <button class="test-button" onclick="runDiagnostics()">Run Full Diagnostics</button>
        <button class="test-button" onclick="clearDebug()">Clear Debug Output</button>
        
        <!-- Registration Modal (copied from main site) -->
        <div id="registrationModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-user-plus"></i> Student Registration</h2>
                    <span class="close" onclick="closeModal('registrationModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="studentRegistrationForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="firstName">First Name *</label>
                                <input type="text" id="firstName" name="firstName" required>
                            </div>
                            <div class="form-group">
                                <label for="lastName">Last Name *</label>
                                <input type="text" id="lastName" name="lastName" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone *</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="faculty">Faculty *</label>
                            <input type="text" id="faculty" name="faculty" required placeholder="e.g., Engineering & Technology">
                        </div>
                        <div class="form-group">
                            <label for="department">Department *</label>
                            <input type="text" id="department" name="department" required placeholder="e.g., Computer Science">
                        </div>
                        <div class="form-group">
                            <label for="yearOfStudy">Year of Study *</label>
                            <select id="yearOfStudy" name="yearOfStudy" required>
                                <option value="">Select Year</option>
                                <option value="1">1st Year</option>
                                <option value="2">2nd Year</option>
                                <option value="3">3rd Year</option>
                                <option value="4">4th Year</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="password">Password *</label>
                            <input type="password" id="password" name="password" required>
                        </div>
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-user-plus"></i> Register as Student
                        </button>
                        <div class="error-div hidden"></div>
                        <div class="success-div hidden"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('debugOutput');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'status-error' : 
                            type === 'warning' ? 'status-warning' : 
                            type === 'success' ? 'status-good' : '';
            
            output.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            output.scrollTop = output.scrollHeight;
        }

        function clearDebug() {
            document.getElementById('debugOutput').innerHTML = '';
        }

        function testModalOpen() {
            log('=== Testing Modal Open ===');
            
            const modal = document.getElementById('registrationModal');
            if (!modal) {
                log('ERROR: Modal element not found!', 'error');
                return;
            }
            
            log('Modal element found', 'success');
            log(`Current display style: ${modal.style.display}`);
            log(`Computed display style: ${getComputedStyle(modal).display}`);
            
            // Test opening
            modal.style.display = 'flex';
            
            log(`After setting display=flex: ${modal.style.display}`);
            log(`Computed display after: ${getComputedStyle(modal).display}`);
            log(`Modal visibility: ${getComputedStyle(modal).visibility}`);
            log(`Modal opacity: ${getComputedStyle(modal).opacity}`);
            log(`Modal z-index: ${getComputedStyle(modal).zIndex}`);
            
            // Check if visible in viewport
            const rect = modal.getBoundingClientRect();
            log(`Modal position: top=${rect.top}, left=${rect.left}, width=${rect.width}, height=${rect.height}`);
            
            if (modal.style.display === 'flex') {
                log('Modal opened successfully!', 'success');
            } else {
                log('Failed to open modal', 'error');
            }
        }

        function testModalClose() {
            log('=== Testing Modal Close ===');
            
            const modal = document.getElementById('registrationModal');
            if (!modal) {
                log('ERROR: Modal element not found!', 'error');
                return;
            }
            
            modal.style.display = 'none';
            log('Modal closed', 'success');
        }

        function runDiagnostics() {
            log('=== Running Full Diagnostics ===');
            
            // Check for modal element
            const modal = document.getElementById('registrationModal');
            log(`Modal element exists: ${modal ? 'YES' : 'NO'}`, modal ? 'success' : 'error');
            
            if (modal) {
                log(`Modal classes: ${modal.className}`);
                log(`Modal parent: ${modal.parentElement ? modal.parentElement.tagName : 'NO PARENT'}`);
            }
            
            // Check for form element
            const form = document.getElementById('studentRegistrationForm');
            log(`Form element exists: ${form ? 'YES' : 'NO'}`, form ? 'success' : 'error');
            
            // Check CSS files
            const stylesheets = Array.from(document.styleSheets);
            log(`Loaded stylesheets: ${stylesheets.length}`);
            stylesheets.forEach((sheet, index) => {
                try {
                    log(`  ${index + 1}. ${sheet.href || 'inline styles'}`);
                } catch (e) {
                    log(`  ${index + 1}. [Access denied or error]`);
                }
            });
            
            // Check for global functions
            log(`openModal function exists: ${typeof openModal !== 'undefined' ? 'YES' : 'NO'}`);
            log(`closeModal function exists: ${typeof closeModal !== 'undefined' ? 'YES' : 'NO'}`);
            
            // Check for any JavaScript errors
            log('Checking for console errors...');
            
            log('=== Diagnostics Complete ===', 'success');
        }

        // Modal functions (same as main site)
        function openModal(modalId) {
            log(`openModal called with: ${modalId}`);
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                log(`Modal ${modalId} opened`, 'success');
            } else {
                log(`Modal ${modalId} not found!`, 'error');
            }
        }

        function closeModal(modalId) {
            log(`closeModal called with: ${modalId}`);
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = '';
                log(`Modal ${modalId} closed`, 'success');
            } else {
                log(`Modal ${modalId} not found!`, 'error');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            log('Debug test page loaded successfully', 'success');
            runDiagnostics();
        });

        // Listen for errors
        window.addEventListener('error', function(e) {
            log(`JavaScript Error: ${e.message} at ${e.filename}:${e.lineno}`, 'error');
        });
    </script>
</body>
</html>